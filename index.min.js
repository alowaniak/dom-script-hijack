function hijackScript(e,t){let n=e instanceof RegExp?t=>e.test(t.src):e,c=new MutationObserver((async e=>{let a=e.flatMap((e=>[...e.addedNodes])).flatMap((e=>e instanceof HTMLScriptElement?e:[])).find(n);if(a){a.remove(),c.disconnect();let e=document.createElement("script");e.type=a.type,e.textContent=t(a.src?await fetch(a.src).then((e=>e.text())):a.textContent??""),document.head.appendChild(e)}}));return c.observe(document,{childList:!0,subtree:!0}),c}
